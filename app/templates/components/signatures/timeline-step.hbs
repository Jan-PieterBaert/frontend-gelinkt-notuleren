{{#component step isOpen=isOpen title=name pill=algemeneStatus icon=iconName as |step|}}
  {{#if loading}}
    <div class="scanner__text">
      <div class="badge badge--accent badge--l badge--initials">
        <span class="loader"><span class="u-visually-hidden">{{loadingText}}</span></span>
      </div>
    </div>
  {{/if}}
  {{#step.block title=title pillColor=voorVertoningStatus.color pillName=voorVertoningStatus.label}}
    {{{mockDocument.body}}}
  {{/step.block}}
  {{#step.block title="Onderteken" pillColor=handtekeningStatus.color pillName=handtekeningStatus.label}}
    <div class="grid">
      {{#if (eq document.signedResources.length 2)}}
        {{!-- Two signatures placed --}}
        {{#each document.signedResources as |signature|}}
          <div class="col--4-12">
            {{signatures/signed-resource signature=signature}}
          </div>
        {{/each}}
      {{else}}
        {{!-- One signature placed --}}
        {{#if (eq document.signedResources.length 1)}}
          <div class="col--4-12">
            {{signatures/signed-resource signature=document.signedResources.firstObject}}
          </div>
          <div class="col--4-12">
            <p class="smaller uppercase text-fade">Tweede handtekening vereist</p>
            {{#wu-button
                 isSmall=true isNarrow=true
                 class="button u-spacer--top--tiny"
                 onClick=(action (mut showSigningModal) true)
                 disabled=(not currentSession.canSign)
            }}
              Onderteken {{name}}
            {{/wu-button}}
          </div>
        {{else}}
          {{!-- No signatures placed --}}
          <div class="col--6-12">
            <p class="smaller uppercase text-fade">Handtekeningen vereist door voorzitter en algemeen directeur met rol <a href="https://gelinkt-notuleren.vlaanderen.be/handleiding/#gebruikersbeheer" target="_blank">ondertekenaar</a></p>
            <!-- dit verschilt voor verschillende organen -->
            {{#wu-button
               class="button u-spacer--top--tiny"
               onClick=(action (mut showSigningModal) true)
               disabled=(not currentSession.canSign)
            }}
              Onderteken {{name}}
            {{/wu-button}}
          </div>
        {{/if}}
        {{#if showSigningModal}}
          {{#wu-modal
             title=(concat "Uw " name " wordt ondertekend")
             dialog-class="modal-dialog--wide modal-dialog--sectioned"
             onClose=(action (mut showPublishingModal) false)
             as |m|}}
            {{#m.content isSectioned=true}}
            <div class="grid">
              <div class="col--6-12">
                {{{mockDocument.body}}}
              </div>
              <div class="col--6-12">
                <p>Waar wordt de {{name}} ondertekend</p>
                <p>
                  De openbare {{name}} worden ondertekend gemaakt.
                </p>
                <p>U kan de onderteken niet omkeren.</p>
              </div>
            </div>
            {{/m.content}}
            <div class="modal-dialog__footer">
              {{#if signingIsLoading}}
                <p>Aan het laden ...</p>
              {{/if}}
              {{#m.buttons as |b|}}
                {{b.button label=(concat "Onderteken " name) onClick=(action 'signDocument' mockDocument.signedId) disabled=signingIsLoading}}
                {{b.button label="Annuleren" onClick=(action (mut showSigningModal) false) isLink=true icon="vi-cross"}}
              {{/m.buttons}}
            </div>
          {{/wu-modal}}
        {{/if}}
      {{/if}}
    </div>
  {{/step.block}}
  {{#step.block title="Publiceer" pillColor=(if document.publishedResource "primary-blue") pillName=(if document.publishedResource "Publiek" "Niet publiek")}}
    <div class="u-background--gray-lightest u-padding--round--small u-spacer--tb--small">
      <div class="grid">
        {{#if document.publishedResource}}
          <div class="col--3-12">
            {{signatures/published-resource signature=document.publishedResource}}
          </div>
          <div class="col--6-12">
            <p class="smallest uppercase text-fade">Link</p>
            <p><a href="https://publicatie.gelinkt-notuleren.vlaanderen.be/{{bestuurseenheid.naam}}/{{bestuurseenheid.classificatie.label}}" class="small u-spacer--tb--tinier" target="_blank">publicatie.gelinkt-notuleren.vlaanderen.be/{{bestuurseenheid.naam}}/{{bestuurseenheid.classificatie.label}}</a></p>
          </div>
          <div class="col--3-12">
            <p class="smaller uppercase text-fade">Type publicatie</p>
            <p class="u-spacer--tb--tinier">Publiek voor iedereen</p>
          </div>
        {{else}}
          <div class="col--8-12">
            <p class="smaller uppercase text-fade">Publicatie door <a href="https://gelinkt-notuleren.vlaanderen.be/handleiding/#gebruikersbeheer" target="_blank">publiceerder</a></p>
            {{#wu-button
               class="button u-spacer--top--tiny"
               onClick=(action (mut showPublishingModal) true)
               disabled=(not currentSession.canPublish)
            }}
              Publiceer {{name}}
            {{/wu-button}}
            <p class="text-fade small">De {{name}} wordt gepubliceerd zoals bovenaan in de voorvertoning naar <a href="https://publicatie.gelinkt-notuleren.vlaanderen.be" target="_blank">publicatie.gelinkt-notuleren.vlaanderen.be</a>, en zal zichtbaar zijn voor iedereen zonder authenticatie.</p>
          </div>
          {{#if showPublishingModal}}
            {{#wu-modal
               title=(concat "Uw " name " wordt gepubliceerd")
               dialog-class="modal-dialog--wide modal-dialog--sectioned"
               onClose=(action (mut showPublishingModal) false)
               as |m|}}
              {{#m.content isSectioned=true}}
              <div class="grid">
                <div class="col--6-12">
                  {{{mockDocument.body}}}
                </div>
                <div class="col--6-12">
                  <p>Waar wordt de {{name}} gepubliceerd</p>
                  <p>
                    De openbare {{name}} worden publiek gemaakt, en is terug te
                    vinden op <a href="https://publicatie.gelinkt-notuleren.lblod.info/">
                      https://publicatie.gelinkt-notuleren.lblod.info/</a>.
                  </p>
                  <p>U kan de publicatie niet omkeren.</p>
                </div>
              </div>
              {{/m.content}}
              <div class="modal-dialog__footer">
                {{#if publishingIsLoading}}
                  <p>Aan het laden ...</p>
                {{/if}}
                {{#m.buttons as |b|}}
                  {{b.button label=(concat "Publiceer " name) onClick=(action 'publishDocument' mockDocument.signedId) disabled=publishingIsLoading}}
                  {{b.button label="Annuleren" onClick=(action (mut showPublishingModal) false) isLink=true icon="vi-cross"}}
                {{/m.buttons}}
              </div>
            {{/wu-modal}}
          {{/if}}
        {{/if}}
      </div>
    </div>
  {{/step.block}}
{{/component}}
